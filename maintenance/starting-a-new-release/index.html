<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>Starting a new release | Foreach Across</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="This page describes the various steps that are usually required to
start a new Across X.Y version.">
    <meta name="generator" content="Hugo 0.121.2">
    
    
    
    
      <meta name="robots" content="index, follow">
    

    
<link rel="stylesheet" href="/ananke/css/main.min.f96b61024fa9430d3974da887e046433b2e934adb2f7c0fd2259cd989344350b.css" >



    

    
      
<link rel="shortcut icon" href="/img/favicon-32x32.ico" type="image/x-icon" />


    

    

    
      <link rel="canonical" href="https://foreach-across.github.io/maintenance/starting-a-new-release/">
    

    <meta property="og:title" content="Starting a new release" />
<meta property="og:description" content="This page describes the various steps that are usually required to
start a new Across X.Y version." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://foreach-across.github.io/maintenance/starting-a-new-release/" /><meta property="article:section" content="maintenance" />



<meta itemprop="name" content="Starting a new release">
<meta itemprop="description" content="This page describes the various steps that are usually required to
start a new Across X.Y version.">

<meta itemprop="wordCount" content="2353">
<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/><meta name="twitter:title" content="Starting a new release"/>
<meta name="twitter:description" content="This page describes the various steps that are usually required to
start a new Across X.Y version."/>

      
    
	
  </head>

  <body class="ma0 avenir bg-near-white production">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        Foreach Across
      
    </a>
    <div class="flex-l items-center">
      

      
        <ul class="pl0 mr3">
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/" title="Home page">
              Home
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/overview/" title="Overview page">
              Overview
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/modules/" title="Modules page">
              Modules
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/docs/" title="Docs page">
              Docs
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/release-notes/" title="Release Notes page">
              Release Notes
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/blog/" title="Blog page">
              Blog
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/maintenance/" title="Maintenance page">
              Maintenance
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/faq/" title="FAQ page">
              FAQ
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/old" title="Old page">
              Old
            </a>
          </li>
          
        </ul>
      
      
<div class="ananke-socials">
  
    
    <a href="https://foreach.be/" target="_blank" rel="noopener" class="Foreach ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="Foreach link" aria-label="follow on Foreach——Opens in a new window">
      
        Foreach
      
<span class="new-window"><svg  height="8px"  style="enable-background:new 0 0 1000 1000;" version="1.1" viewBox="0 0 1000 1000"  xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
<path d="M598 128h298v298h-86v-152l-418 418-60-60 418-418h-152v-86zM810 810v-298h86v298c0 46-40 86-86 86h-596c-48 0-86-40-86-86v-596c0-46 38-86 86-86h298v86h-298v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;"/>
</svg>
</span></a>
  
    
    <a href="https://www.youtube.com/watch?v=00Jn3d12L2M" target="_blank" rel="noopener" class="youtube ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="YouTube link" aria-label="follow on YouTube——Opens in a new window">
      
        <span class="icon"><svg style="enable-background:new 0 0 67 67;" version="1.1" viewBox="0 0 67 67"  xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M42.527,41.34c-0.278,0-0.478,0.078-0.6,0.244  c-0.121,0.156-0.18,0.424-0.18,0.796v0.896h1.543V42.38c0-0.372-0.062-0.64-0.185-0.796C42.989,41.418,42.792,41.34,42.527,41.34z   M36.509,41.309c0.234,0,0.417,0.076,0.544,0.23c0.123,0.155,0.185,0.383,0.185,0.682v4.584c0,0.286-0.053,0.487-0.153,0.611  c-0.1,0.127-0.256,0.189-0.47,0.189c-0.148,0-0.287-0.033-0.421-0.096c-0.135-0.062-0.274-0.171-0.415-0.313v-5.531  c0.119-0.122,0.239-0.213,0.36-0.271C36.26,41.335,36.383,41.309,36.509,41.309z M41.748,44.658v1.672  c0,0.468,0.057,0.792,0.17,0.974c0.118,0.181,0.313,0.269,0.592,0.269c0.289,0,0.491-0.076,0.606-0.229  c0.114-0.153,0.175-0.489,0.175-1.013v-0.405h1.795v0.456c0,0.911-0.217,1.596-0.657,2.059c-0.435,0.459-1.089,0.687-1.958,0.687  c-0.781,0-1.398-0.242-1.847-0.731c-0.448-0.486-0.676-1.157-0.676-2.014v-3.986c0-0.768,0.249-1.398,0.742-1.882  c0.493-0.484,1.128-0.727,1.911-0.727c0.799,0,1.413,0.225,1.843,0.674c0.429,0.448,0.642,1.093,0.642,1.935v2.264H41.748z   M38.623,48.495c-0.271,0.336-0.669,0.501-1.187,0.501c-0.343,0-0.646-0.062-0.912-0.192c-0.267-0.129-0.519-0.327-0.746-0.601  v0.681h-1.764V36.852h1.764v3.875c0.237-0.27,0.485-0.478,0.748-0.616c0.267-0.143,0.534-0.212,0.805-0.212  c0.554,0,0.975,0.189,1.265,0.565c0.294,0.379,0.438,0.933,0.438,1.66v4.926C39.034,47.678,38.897,48.159,38.623,48.495z   M30.958,48.884v-0.976c-0.325,0.361-0.658,0.636-1.009,0.822c-0.349,0.191-0.686,0.282-1.014,0.282  c-0.405,0-0.705-0.129-0.913-0.396c-0.201-0.266-0.305-0.658-0.305-1.189v-7.422h1.744v6.809c0,0.211,0.037,0.362,0.107,0.457  c0.077,0.095,0.196,0.141,0.358,0.141c0.128,0,0.292-0.062,0.488-0.188c0.197-0.125,0.375-0.283,0.542-0.475v-6.744h1.744v8.878  H30.958z M24.916,38.6v10.284h-1.968V38.6h-2.034v-1.748h6.036V38.6H24.916z M32.994,32.978c0-0.001,12.08,0.018,13.514,1.45  c1.439,1.435,1.455,8.514,1.455,8.555c0,0-0.012,7.117-1.455,8.556C45.074,52.969,32.994,53,32.994,53s-12.079-0.031-13.516-1.462  c-1.438-1.435-1.441-8.502-1.441-8.556c0-0.041,0.004-7.12,1.441-8.555C20.916,32.996,32.994,32.977,32.994,32.978z M42.52,29.255  h-1.966v-1.08c-0.358,0.397-0.736,0.703-1.13,0.909c-0.392,0.208-0.771,0.312-1.14,0.312c-0.458,0-0.797-0.146-1.027-0.437  c-0.229-0.291-0.345-0.727-0.345-1.311v-8.172h1.962v7.497c0,0.231,0.045,0.399,0.127,0.502c0.08,0.104,0.216,0.156,0.399,0.156  c0.143,0,0.327-0.069,0.548-0.206c0.22-0.137,0.423-0.312,0.605-0.527v-7.422h1.966V29.255z M31.847,27.588  c0.139,0.147,0.339,0.219,0.6,0.219c0.266,0,0.476-0.075,0.634-0.223c0.157-0.152,0.235-0.358,0.235-0.618v-5.327  c0-0.214-0.08-0.387-0.241-0.519c-0.16-0.131-0.37-0.196-0.628-0.196c-0.241,0-0.435,0.065-0.586,0.196  c-0.148,0.132-0.225,0.305-0.225,0.519v5.327C31.636,27.233,31.708,27.439,31.847,27.588z M30.408,19.903  c0.528-0.449,1.241-0.674,2.132-0.674c0.812,0,1.48,0.237,2.001,0.711c0.517,0.473,0.777,1.083,0.777,1.828v5.051  c0,0.836-0.255,1.491-0.762,1.968c-0.513,0.476-1.212,0.714-2.106,0.714c-0.858,0-1.547-0.246-2.064-0.736  c-0.513-0.492-0.772-1.152-0.772-1.983v-5.068C29.613,20.954,29.877,20.351,30.408,19.903z M24.262,16h-2.229l2.634,8.003v5.252  h2.213v-5.5L29.454,16h-2.25l-1.366,5.298h-0.139L24.262,16z M33,64C16.432,64,3,50.569,3,34S16.432,4,33,4s30,13.431,30,30  S49.568,64,33,64z" style="fill-rule:evenodd;clip-rule:evenodd;"/></svg>
</span>
      
<span class="new-window"><svg  height="8px"  style="enable-background:new 0 0 1000 1000;" version="1.1" viewBox="0 0 1000 1000"  xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
<path d="M598 128h298v298h-86v-152l-418 418-60-60 418-418h-152v-86zM810 810v-298h86v298c0 46-40 86-86 86h-596c-48 0-86-40-86-86v-596c0-46 38-86 86-86h298v86h-298v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;"/>
</svg>
</span></a>
  
    
    <a href="https://github.com/foreach-across/" target="_blank" rel="noopener" class="github ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="GitHub link" aria-label="follow on GitHub——Opens in a new window">
      
        <span class="icon"><svg style="enable-background:new 0 0 512 512;" version="1.1" viewBox="0 0 512 512"  xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
  <path d="M256,32C132.3,32,32,134.8,32,261.7c0,101.5,64.2,187.5,153.2,217.9c11.2,2.1,15.3-5,15.3-11.1   c0-5.5-0.2-19.9-0.3-39.1c-62.3,13.9-75.5-30.8-75.5-30.8c-10.2-26.5-24.9-33.6-24.9-33.6c-20.3-14.3,1.5-14,1.5-14   c22.5,1.6,34.3,23.7,34.3,23.7c20,35.1,52.4,25,65.2,19.1c2-14.8,7.8-25,14.2-30.7c-49.7-5.8-102-25.5-102-113.5   c0-25.1,8.7-45.6,23-61.6c-2.3-5.8-10-29.2,2.2-60.8c0,0,18.8-6.2,61.6,23.5c17.9-5.1,37-7.6,56.1-7.7c19,0.1,38.2,2.6,56.1,7.7   c42.8-29.7,61.5-23.5,61.5-23.5c12.2,31.6,4.5,55,2.2,60.8c14.3,16.1,23,36.6,23,61.6c0,88.2-52.4,107.6-102.3,113.3   c8,7.1,15.2,21.1,15.2,42.5c0,30.7-0.3,55.5-0.3,63c0,6.1,4,13.3,15.4,11C415.9,449.1,480,363.1,480,261.7   C480,134.8,379.7,32,256,32z"/>
</svg>
</span>
      
<span class="new-window"><svg  height="8px"  style="enable-background:new 0 0 1000 1000;" version="1.1" viewBox="0 0 1000 1000"  xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
<path d="M598 128h298v298h-86v-152l-418 418-60-60 418-418h-152v-86zM810 810v-298h86v298c0 46-40 86-86 86h-596c-48 0-86-40-86-86v-596c0-46 38-86 86-86h298v86h-298v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;"/>
</svg>
</span></a>
  
</div>

    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked ttu">
          
        Maintenance
      </aside>
      










  <div id="sharing" class="mt3 ananke-socials">
    
  </div>


      <h1 class="f1 athelas mt3 mb1">Starting a new release</h1>
      
      
      

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><p>This page describes the various steps that are usually required to
start a new Across X.Y version.</p>
<p>These instructions assume Across 6.x, where framework, platform and
all modules all have the same version. For 5.x you&rsquo;ll have a much
harder time.</p>
<p>The example here is for 6.0 -&gt; 6.1, but adapt as needed of course.</p>
<h2 id="read-the-spring-boot-release-notes">Read the Spring Boot release notes</h2>
<p>Read the release notes in the <a href="https://github.com/spring-projects/spring-boot/wiki">Spring Boot
Wiki</a>. These are
pretty good, without being too long (considering the scope of Spring
Boot!). They also come with a list of dependency upgrades, usually
with a link to the corresponding release notes. You obviously can&rsquo;t
and shouldn&rsquo;t read all of those, but if you encounter problems with a
specific dependency during the next steps, you can easily find a
high-quality source there.</p>
<h2 id="create-a-new-branch">Create a new branch</h2>
<ol>
<li>
<p>Make sure your repositories are clean: no uncommitted files and no
unpushed commits etc.</p>
</li>
<li>
<p>Make sure all your repositories are up to date:</p>
<pre><code> ax-exec.sh git fetch -p
</code></pre>
<p>In fact, an even better option is to clone a fresh top-level
<code>across-development</code> repo (and locally name it <code>6.1</code> in this
example), and the child repositories, as explained in <a href="/maintenance/getting-started/">Getting
started</a>:</p>
</li>
<li>
<p>Then create a 6.1 branch starting from the latest commit on the
remote 6.0 branch, for each repository:</p>
<pre><code> ax-exec.sh git checkout -b 6.1 origin/6.0
</code></pre>
</li>
<li>
<p>In IntelliJ, search and replace <code>6.0-SNAPSHOT</code> with
<code>6.1-SNAPSHOT</code>. This should in principle only occur in the
<code>.gitlab-ci.yml</code> files, but you better check. Obviously do not
update it in this file, or you will mess up this documentation.</p>
</li>
<li>
<p>Commit and push the 6.1 branch for the <code>across-framework</code>
directory:</p>
<pre><code> cd across-framework
 git push -u origin HEAD --dry-run
 git push -u origin HEAD
</code></pre>
</li>
<li>
<p>Next, commit and push each of the following repositories, but ONLY
AFTER the build of the previous one was successful (otherwise there
will be no <code>6.1-SNAPSHOT</code> artifacts on the Nexus server to download
as dependencies).</p>
</li>
</ol>
<h2 id="upgrade-using-openrewrite">Upgrade using OpenRewrite</h2>
<p>The first option to try is
<a href="https://docs.openrewrite.org/">OpenRewrite</a>. For the example of
Across 6.1, we want to upgrade to Spring Boot 3.3, so use the <a href="https://docs.openrewrite.org/recipes/java/spring/boot3/upgradespringboot_3_3">Spring
Boot 3.3
recipe</a>. I
always use the &ldquo;Maven Command Line&rdquo; option to run an OpenRewrite
recipe.</p>
<p>Try to use OpenRewrite first from the top-level repositories,
e.g. apply it over all repositories in one. If that does not work, it
might work by applying it on each repository one-by-one, in the right
order.</p>
<p>Even when running the OpenRewrite recipe works, it doesn&rsquo;t do
miracles. You may still have to fix compilation errors by hand, and
it&rsquo;s not magically going to fix the tests. In fact, the changes it
does, might also break stuff, and the easiest (and probably best)
solution is to revert a specific change &hellip; That has one big
disadvantage: OpenRewrite will probably do the same thing on the next
upgrade cycle:</p>
<ul>
<li>
<p>Add a comment near the specific code that OpenRewrite messes up, to
remind the next person doing the upgrade.</p>
</li>
<li>
<p>The OpenRewrite Maven Plugin also has an <a href="https://docs.openrewrite.org/reference/rewrite-maven-plugin#plugin-configuration"><code>&lt;exclusions&gt;</code> option to
skip entire
files/directories</a>. That
might be too coarse-grained, so use your best judgement.</p>
</li>
</ul>
<h2 id="upgrade-the-spring-boot-version-number">Upgrade the Spring Boot version number</h2>
<p>In fact, my experience is that OpenRewrite is usually able to update
the code, but does not upgrade the Spring Boot version in the
<code>pom.xml</code> file, possibly due to the relatively specific Maven modules
organization of Across. You have to check the Spring Boot version
number in the <code>&lt;parent&gt;</code> section in these two <code>pom.xml</code> files:</p>
<pre><code>across-framework/across-core-dependencies/pom.xml
across-platform/across-application-parent/pom.xml
</code></pre>
<p>and if necessary, manually set that to the right version. The parent
POM is <code>spring-boot-dependencies</code> for <code>across-core-dependencies</code> and
<code>spring-boot-starter-parent</code> for <code>across-application-parent</code>, but
these two always have the same version. You can find all possible
versions numbers at:</p>
<p><a href="https://central.sonatype.com/artifact/org.springframework.boot/spring-boot-dependencies/versions">https://central.sonatype.com/artifact/org.springframework.boot/spring-boot-dependencies/versions</a></p>
<h2 id="fixing-compilations-errors">Fixing compilations errors</h2>
<p>This is obviously the first step after running OpenRewrite and/or
manually upgrading the version numbers. Most of the time these are
small things (especially in X.Y+1 upgrades). Use common sense, Google,
StackOverflow whatever to fix these.</p>
<p>Once <code>across-framework</code> compiles, you have two options:</p>
<ol>
<li>
<p>Either first fix the tests of <code>across-framework</code>.</p>
</li>
<li>
<p>Make all the other repositories compile first.</p>
</li>
</ol>
<p>Of course, it depends on the situation, but I usually go for the
second option to detect ASAP if there&rsquo;s any big breaking compilation
issues in the rest of Across. As soon as you have everything
compiling, you can immediately try to run one of the test applications
in Across (without first having to fix all tests). Two of the most
important ones are:</p>
<ul>
<li>
<p><code>EntityModuleTestApplication</code> (of course you can try this as soon as
<code>entity-module</code> compiles).</p>
</li>
<li>
<p><code>PlatformTestApplication</code>: This one is important because it tests
the combination of <code>entity-module</code> and associates, with
<code>user-module</code>.</p>
</li>
</ul>
<p>If these work (or at least start up) you know already a lot. Whereas
fixing the tests repository by repository, module by module, can be
quite a bit of work, with relatively little real-world feedback.</p>
<p>But most importantly, at this point, you can <a href="#fixing-the-tests">skip the step of fixing
the tests</a> (for now obviously), and
already <a href="#tryout-with-an-application">give a <em>real</em> application a try</a>, so we&rsquo;ll keep that order in this
documentation. But first we need to explain the
<code>dependencies.list/.tree.txt</code> files.</p>
<h2 id="dependencieslisttxt--dependenciestreetxt">dependencies.list.txt / dependencies.tree.txt</h2>
<p>The Across git repositories (and at least one application repository)
have the following files next to each <code>pom.xml</code> file:</p>
<pre><code>dependency.list.txt
dependency.tree.txt
</code></pre>
<p>These are generated using the <code>generate-dependencies.sh</code> script in the
<code>bin</code> directory of the <code>across-development</code> repository, which is put
in your <code>PATH</code> when you source the <code>env.sh</code> script (See <a href="/maintenance/getting-started/#initial-maven-build">Getting
started</a>. This
script is a wrapper around the following Maven goals:</p>
<ul>
<li><a href="https://maven.apache.org/plugins/maven-dependency-plugin/list-mojo.html"><code>maven-dependency-plugin:list</code></a></li>
<li><a href="https://maven.apache.org/plugins/maven-dependency-plugin/tree-mojo.html"><code>maven-dependency-plugin:tree</code></a></li>
</ul>
<p>The <code>dependency.list.txt</code> file contains an alphabetically sorted list
of artifacts that the Maven module depends on, directly or indirectly,
as chosen by the <a href="https://maven.apache.org/guides/introduction/introduction-to-dependency-mechanism.html">Maven dependency selection
algorithm</a>
(Mathematically speaking, this is the <a href="https://en.wikipedia.org/wiki/Transitive_closure">transitive
closure</a> of the
dependency graph). This file is easy to diff against previous
versions, so that you can clearly see all updates that have been done,
and which dependency versions are actually used (which is sometimes
non-trivial). This is also the reason why we commit these files to
version control.</p>
<p>The <code>dependency.tree.txt</code> file shows the dependency graph of the
module, but reduced to a tree structure, according to the algorithm
that Maven uses to select artifact versions. So if you are wondering
where a specific dependency (or version of that dependency) comes
from, you can find it here.</p>
<p>Unfortunately, there is no easy way to ensure these two files are kept
in sync with changes to the <code>pom.xml</code> files, so that burden is on
you. At least the script can simply be run from the top-level
directory (e.g. in the <code>across-development</code> repository):</p>
<pre><code>generate-dependencies.sh
</code></pre>
<p>The script also checks that there are no dependencies with more than
one version, in all of Across. Unfortunately there is one artifact (in
<code>across-autoconfigure</code>, also see the note about that in further) for
which that is not the case:</p>
<pre><code>ERROR: There are 1 dependencies with multiple versions:
  2 org.springframework.plugin:spring-plugin-core
</code></pre>
<p>But so far that has not caused any issues, so you can safely ignore
it.</p>
<p>Finally, the rule to remember is simple: Whenever you make any change
to a <code>pom.xml</code> file, and once <code>mciwt</code> over all repositories compiles
everything OK, you should re-run <code>generate-dependencies.sh</code>. And make
sure to commit that together with the <code>pom.xml</code> versions.</p>
<p>Here are a few more tips about visualizing dependencies:</p>
<ul>
<li>
<p>The <code>dependency:tree</code> goal can also generate a <code>.dot</code> file, which
can be graphically plotted using
<a href="https://graphviz.org/">GraphViz</a>. Note that dependency graphs can
be enormous, and because of that, you usually want to plot the
dependency graph with all redundant dependencies removed
(mathematically called <a href="https://en.wikipedia.org/wiki/Transitive_reduction">the transitive
reduction</a>)</p>
<pre><code>  tred graph.dot | dot -Tsvg &gt; graph.svg
</code></pre>
<p>But even then it will still be big. The <code>tree</code> goal also have
options to include/exclude specific dependencies to help with that.</p>
<p>I usually use SVG as the output format, because when you open that
in a browser, you can actually <em>search</em> for any text in the graph,
which is very useful in a large graph.</p>
</li>
<li>
<p>There is also an <code>ax-dependencies.py</code> script (which is not based on
the <code>maven-dependency-plugin</code>), but whose output is a <code>.dot</code> file as
well. Run the script with <code>--help</code> for more info. This script was
used to generate the dependency plot at the bottom of the <a href="https://foreach-across.github.io/modules/#module-dependency-graph">Modules
page</a>.</p>
</li>
</ul>
<h2 id="tryout-with-an-application">Tryout with an application</h2>
<p>Of course, you can only try this with an application that is already
up-to-date with Across / Spring Boot upgrades (or at least pretty up
to date).</p>
<p>There is also a practical issue now: if the tests are still failing in
CI at this moment, then there are also no X.Y-SNAPSHOT (6.1-SNAPSHOT
in this example) jar files being published to the internal Nexus
server. So you can&rsquo;t compile the application against those
snapshots. This can also be considered a blessing in desguise, because
working against snapshots downloaded from a repository isn&rsquo;t easy
either, due to Maven caching in your local repository. This command
will quickly become your friend:</p>
<pre><code>rm -rf ~/.m2/repository/com/foreach
</code></pre>
<p>(which is also still useful with the alternative I&rsquo;ll present).</p>
<p>Also: Make sure you do <em>not</em> accidentally hit <code>enter</code> after the <code>~/</code>:
you&rsquo;ll wipe out your entire home directory :-(. Which is why you
better do this:</p>
<pre><code>rm ~/.m2/repository/com/foreach -rf
</code></pre>
<p>The solution for the missing X.Y-SNAPSHOT jars is:</p>
<ol>
<li>
<p>Compile all of Across (from the top-level directory) with the
<code>mciwt</code> alias (<code>wt</code> = without tests because you want to iterate
fast). This installs (the <code>i</code> in <code>mciwt</code>) the Across maven
artifacts in your local Maven repository with version
<code>dev-SNAPSHOT</code>. There are never artifacts with version
<code>dev-SNAPSHOT</code> published to the Nexus server (unless somebody
changes the CI/CD setup), so you know this is always whatever the
last code is that you have built locally.</p>
</li>
<li>
<p>Change Across version property/properties in your application to
<code>dev-SNAPSHOT</code> to pick up those artifacts.</p>
</li>
</ol>
<p>When you have to go back and forth between making a change in Across,
and testing it with the application, this is definitely a much better
developer experience, with a much faster edit-compile-debug cycle.</p>
<h2 id="fixing-the-tests">Fixing the tests</h2>
<p>I like to run all tests using Maven on my laptop: it&rsquo;s a much faster
feedback loop than CI, and using the <code>--fail-at-end</code> option, I can get
feedback over multiple repositories in one go. Also: if there are many
failures, there&rsquo;s a good chance there are just a few root causes
behind the majority of the failures, and this can give a better
overview of the issues.</p>
<p>See <a href="/maintenance/getting-started/#running-tests-with-maven">Getting started</a> for the right
commands and configuration.</p>
<p>The most annoying thing that can happen here is that you have to
continuously go back and forth between fixing tests and making changes
in a low-level repository (e.g. <code>across-framework</code>) and a high-level
repository (e.g. <code>across-entity-admin-modules</code>), and possibly even the
real application that you have chosen. This is another reason why I
like to give a real application a try before attempting to fix all the
failing tests. And using <code>dev-SNAPSHOT</code> in the application results in
a faster edit-compile-debug cycle.</p>
<p>If you upgraded any dependencies in this step, or even changed any
<code>pom.xml</code> file, make sure to re-run the <code>generate-dependencies.sh</code>
script.</p>
<h2 id="upgrade-other-dependencies">Upgrade other dependencies</h2>
<p>Across also uses a number of dependencies whose version is not managed
by
<a href="https://central.sonatype.com/artifact/org.springframework.boot/spring-boot-dependencies/versions"><code>spring-boot-dependencies</code></a>. This
includes for example:</p>
<ul>
<li>testcontainers</li>
<li>guava</li>
<li>httpclient4</li>
<li>&hellip;</li>
</ul>
<p>You can find these in the two <code>pom.xml</code> files that were also mentioned
earlier:</p>
<pre><code>across-framework/across-core-dependencies/pom.xml
across-platform/across-application-parent/pom.xml
</code></pre>
<p>And in the top-level <code>pom.xml</code> files of all repositories.</p>
<p>You may have had to upgrade some of these dependencies to fix
compilation or to fix the tests in one of the previous steps. Now that
all tests are working, it is a good time to go through all other
version dependencies, and upgrade them if sensible. Ensure that the
versions are in sync in all repositories (<code>generate-dependencies.sh</code>
helps with that).</p>
<p>There is one exception: Do not try to upgrade the dependencies in
<code>across-autoconfigure</code>, unless absolutely necessary. Experience is
that that just creates more trouble than it&rsquo;s worth, and many of these
dependencies just shouldn&rsquo;t be upgraded. In fact, when there are
problems with some of the test modules of <code>across-autoconfigure</code>, I
have often just disabled such a test module, because it tests an
integration with something that no active project uses anymore (such
as Cassandra, MongoDB, &hellip;).</p>
<p>Important: The two <code>pom.xml</code> files from above contain a set of
(version) properties that have to kept in sync <em>exactly</em> (this wasn&rsquo;t
always the case in the past, leading to some surprises).</p>
<p>These are marked by the comments (in the different files):</p>
<pre><code>&lt;!-- Keep in sync with across-application-parent --&gt;
&lt;!-- Keep in sync with across-core-dependencies --&gt;
</code></pre>
<p>respectively. Use for example <code>kdiff3</code> to verify this:</p>
<pre><code>kdiff3 across-framework/across-core-dependencies/pom.xml across-platform/across-application-parent/pom.xml
</code></pre>
<p>I recommend that you only push these upgrades in all the repositories,
once the tests all pass on your laptop. Otherwise you risk have to go
back and forth with upgrading in one repository, which breaks the next
one, and then you have to go back to the previous one, etc etc.</p>
<p>Alternatively, use a feature branch for these upgrades, and a <code>git merge --squash</code> to merge it to the <code>X.Y</code> branch.</p>
<p>Again, you likely changed some <code>pom.xml</code> files in this step, so make
sure to re-run the <code>generate-dependencies.sh</code> script before pushing
your changes.</p>
<h2 id="re-test-the-application">Re-test the application</h2>
<p>You&rsquo;ve made some more changes to Across in the mean time (fix tests,
upgraded other dependencies), so you should definitely re-test your
application at this point.</p>
<p>Now is also a good time to have another colleague do some functional
testing as well.</p>
<p>You should also deploy the application to a test environment at this
point, to ensure it works there as well (we have seen cases where
there was a startup issue at this point, possibly requiring some
configuration or IaC changes).</p>
<h2 id="next-steps">Next steps</h2>
<p>Ideally, you should upgrade and test another application at this
point, but that may not always be realistic.</p>
<p>By the time you get to this point, there may already have been a new
maintenance release of Spring Boot (.Z in X.Y.Z, these are monthly),
for the major version that you are upgrading to. So make sure you are
on the latest maintenance release and that you re-run
<code>generate-dependencies.sh</code> afterwards.</p>
<p>In principle, you are now ready <a href="/maintenance/release-procedure/">to make a release build</a>.</p>
<p>Once the release build is finished, don&rsquo;t forget to update the
applications, and replace the -SNAPSHOT versions in the <code>pom.xml</code>
file(s) with the released version.</p><ul class="pa0">
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l"> 

<div class="bg-light-gray pa3 nested-list-reset nested-copy-line-height nested-links">
    <p class="f5 b mb3">What&#39;s in this maintenance</p>
    <nav id="TableOfContents">
  <ul>
    <li><a href="#read-the-spring-boot-release-notes">Read the Spring Boot release notes</a></li>
    <li><a href="#create-a-new-branch">Create a new branch</a></li>
    <li><a href="#upgrade-using-openrewrite">Upgrade using OpenRewrite</a></li>
    <li><a href="#upgrade-the-spring-boot-version-number">Upgrade the Spring Boot version number</a></li>
    <li><a href="#fixing-compilations-errors">Fixing compilations errors</a></li>
    <li><a href="#dependencieslisttxt--dependenciestreetxt">dependencies.list.txt / dependencies.tree.txt</a></li>
    <li><a href="#tryout-with-an-application">Tryout with an application</a></li>
    <li><a href="#fixing-the-tests">Fixing the tests</a></li>
    <li><a href="#upgrade-other-dependencies">Upgrade other dependencies</a></li>
    <li><a href="#re-test-the-application">Re-test the application</a></li>
    <li><a href="#next-steps">Next steps</a></li>
  </ul>
</nav>
</div>






</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://foreach-across.github.io/" >
    &copy;  Foreach Across 2025 
  </a>
    <div>
<div class="ananke-socials">
  
    
    <a href="https://foreach.be/" target="_blank" rel="noopener" class="Foreach ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="Foreach link" aria-label="follow on Foreach——Opens in a new window">
      
        Foreach
      
<span class="new-window"><svg  height="8px"  style="enable-background:new 0 0 1000 1000;" version="1.1" viewBox="0 0 1000 1000"  xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
<path d="M598 128h298v298h-86v-152l-418 418-60-60 418-418h-152v-86zM810 810v-298h86v298c0 46-40 86-86 86h-596c-48 0-86-40-86-86v-596c0-46 38-86 86-86h298v86h-298v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;"/>
</svg>
</span></a>
  
    
    <a href="https://www.youtube.com/watch?v=00Jn3d12L2M" target="_blank" rel="noopener" class="youtube ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="YouTube link" aria-label="follow on YouTube——Opens in a new window">
      
        <span class="icon"><svg style="enable-background:new 0 0 67 67;" version="1.1" viewBox="0 0 67 67"  xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M42.527,41.34c-0.278,0-0.478,0.078-0.6,0.244  c-0.121,0.156-0.18,0.424-0.18,0.796v0.896h1.543V42.38c0-0.372-0.062-0.64-0.185-0.796C42.989,41.418,42.792,41.34,42.527,41.34z   M36.509,41.309c0.234,0,0.417,0.076,0.544,0.23c0.123,0.155,0.185,0.383,0.185,0.682v4.584c0,0.286-0.053,0.487-0.153,0.611  c-0.1,0.127-0.256,0.189-0.47,0.189c-0.148,0-0.287-0.033-0.421-0.096c-0.135-0.062-0.274-0.171-0.415-0.313v-5.531  c0.119-0.122,0.239-0.213,0.36-0.271C36.26,41.335,36.383,41.309,36.509,41.309z M41.748,44.658v1.672  c0,0.468,0.057,0.792,0.17,0.974c0.118,0.181,0.313,0.269,0.592,0.269c0.289,0,0.491-0.076,0.606-0.229  c0.114-0.153,0.175-0.489,0.175-1.013v-0.405h1.795v0.456c0,0.911-0.217,1.596-0.657,2.059c-0.435,0.459-1.089,0.687-1.958,0.687  c-0.781,0-1.398-0.242-1.847-0.731c-0.448-0.486-0.676-1.157-0.676-2.014v-3.986c0-0.768,0.249-1.398,0.742-1.882  c0.493-0.484,1.128-0.727,1.911-0.727c0.799,0,1.413,0.225,1.843,0.674c0.429,0.448,0.642,1.093,0.642,1.935v2.264H41.748z   M38.623,48.495c-0.271,0.336-0.669,0.501-1.187,0.501c-0.343,0-0.646-0.062-0.912-0.192c-0.267-0.129-0.519-0.327-0.746-0.601  v0.681h-1.764V36.852h1.764v3.875c0.237-0.27,0.485-0.478,0.748-0.616c0.267-0.143,0.534-0.212,0.805-0.212  c0.554,0,0.975,0.189,1.265,0.565c0.294,0.379,0.438,0.933,0.438,1.66v4.926C39.034,47.678,38.897,48.159,38.623,48.495z   M30.958,48.884v-0.976c-0.325,0.361-0.658,0.636-1.009,0.822c-0.349,0.191-0.686,0.282-1.014,0.282  c-0.405,0-0.705-0.129-0.913-0.396c-0.201-0.266-0.305-0.658-0.305-1.189v-7.422h1.744v6.809c0,0.211,0.037,0.362,0.107,0.457  c0.077,0.095,0.196,0.141,0.358,0.141c0.128,0,0.292-0.062,0.488-0.188c0.197-0.125,0.375-0.283,0.542-0.475v-6.744h1.744v8.878  H30.958z M24.916,38.6v10.284h-1.968V38.6h-2.034v-1.748h6.036V38.6H24.916z M32.994,32.978c0-0.001,12.08,0.018,13.514,1.45  c1.439,1.435,1.455,8.514,1.455,8.555c0,0-0.012,7.117-1.455,8.556C45.074,52.969,32.994,53,32.994,53s-12.079-0.031-13.516-1.462  c-1.438-1.435-1.441-8.502-1.441-8.556c0-0.041,0.004-7.12,1.441-8.555C20.916,32.996,32.994,32.977,32.994,32.978z M42.52,29.255  h-1.966v-1.08c-0.358,0.397-0.736,0.703-1.13,0.909c-0.392,0.208-0.771,0.312-1.14,0.312c-0.458,0-0.797-0.146-1.027-0.437  c-0.229-0.291-0.345-0.727-0.345-1.311v-8.172h1.962v7.497c0,0.231,0.045,0.399,0.127,0.502c0.08,0.104,0.216,0.156,0.399,0.156  c0.143,0,0.327-0.069,0.548-0.206c0.22-0.137,0.423-0.312,0.605-0.527v-7.422h1.966V29.255z M31.847,27.588  c0.139,0.147,0.339,0.219,0.6,0.219c0.266,0,0.476-0.075,0.634-0.223c0.157-0.152,0.235-0.358,0.235-0.618v-5.327  c0-0.214-0.08-0.387-0.241-0.519c-0.16-0.131-0.37-0.196-0.628-0.196c-0.241,0-0.435,0.065-0.586,0.196  c-0.148,0.132-0.225,0.305-0.225,0.519v5.327C31.636,27.233,31.708,27.439,31.847,27.588z M30.408,19.903  c0.528-0.449,1.241-0.674,2.132-0.674c0.812,0,1.48,0.237,2.001,0.711c0.517,0.473,0.777,1.083,0.777,1.828v5.051  c0,0.836-0.255,1.491-0.762,1.968c-0.513,0.476-1.212,0.714-2.106,0.714c-0.858,0-1.547-0.246-2.064-0.736  c-0.513-0.492-0.772-1.152-0.772-1.983v-5.068C29.613,20.954,29.877,20.351,30.408,19.903z M24.262,16h-2.229l2.634,8.003v5.252  h2.213v-5.5L29.454,16h-2.25l-1.366,5.298h-0.139L24.262,16z M33,64C16.432,64,3,50.569,3,34S16.432,4,33,4s30,13.431,30,30  S49.568,64,33,64z" style="fill-rule:evenodd;clip-rule:evenodd;"/></svg>
</span>
      
<span class="new-window"><svg  height="8px"  style="enable-background:new 0 0 1000 1000;" version="1.1" viewBox="0 0 1000 1000"  xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
<path d="M598 128h298v298h-86v-152l-418 418-60-60 418-418h-152v-86zM810 810v-298h86v298c0 46-40 86-86 86h-596c-48 0-86-40-86-86v-596c0-46 38-86 86-86h298v86h-298v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;"/>
</svg>
</span></a>
  
    
    <a href="https://github.com/foreach-across/" target="_blank" rel="noopener" class="github ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="GitHub link" aria-label="follow on GitHub——Opens in a new window">
      
        <span class="icon"><svg style="enable-background:new 0 0 512 512;" version="1.1" viewBox="0 0 512 512"  xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
  <path d="M256,32C132.3,32,32,134.8,32,261.7c0,101.5,64.2,187.5,153.2,217.9c11.2,2.1,15.3-5,15.3-11.1   c0-5.5-0.2-19.9-0.3-39.1c-62.3,13.9-75.5-30.8-75.5-30.8c-10.2-26.5-24.9-33.6-24.9-33.6c-20.3-14.3,1.5-14,1.5-14   c22.5,1.6,34.3,23.7,34.3,23.7c20,35.1,52.4,25,65.2,19.1c2-14.8,7.8-25,14.2-30.7c-49.7-5.8-102-25.5-102-113.5   c0-25.1,8.7-45.6,23-61.6c-2.3-5.8-10-29.2,2.2-60.8c0,0,18.8-6.2,61.6,23.5c17.9-5.1,37-7.6,56.1-7.7c19,0.1,38.2,2.6,56.1,7.7   c42.8-29.7,61.5-23.5,61.5-23.5c12.2,31.6,4.5,55,2.2,60.8c14.3,16.1,23,36.6,23,61.6c0,88.2-52.4,107.6-102.3,113.3   c8,7.1,15.2,21.1,15.2,42.5c0,30.7-0.3,55.5-0.3,63c0,6.1,4,13.3,15.4,11C415.9,449.1,480,363.1,480,261.7   C480,134.8,379.7,32,256,32z"/>
</svg>
</span>
      
<span class="new-window"><svg  height="8px"  style="enable-background:new 0 0 1000 1000;" version="1.1" viewBox="0 0 1000 1000"  xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
<path d="M598 128h298v298h-86v-152l-418 418-60-60 418-418h-152v-86zM810 810v-298h86v298c0 46-40 86-86 86h-596c-48 0-86-40-86-86v-596c0-46 38-86 86-86h298v86h-298v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;"/>
</svg>
</span></a>
  
</div>
</div>
  </div>
</footer>

  </body>
</html>
